INSERT INTO students(Student_ID, First_Name, Last_Name,Birth_Date)
SELECT 
Student_ID, 
First_Name, 
Last_Name,
Birth_Date 
FROM students_raw;

INSERT INTO subjects (Subject_Name)
VALUES
('Math'),
('Physics'),
('Chemistry'),
('Biology'),
('English'),
('History');

INSERT INTO Scores (Student_ID, Subject_ID, Score)
SELECT r.Student_ID, s.Subject_ID, r.Math
FROM students_raw r
JOIN Subjects s ON s.Subject_Name = 'Math';

INSERT INTO Scores (Student_ID, Subject_ID, Score)
SELECT r.Student_ID, s.Subject_ID, r.Physics
FROM students_raw r
JOIN Subjects s ON s.Subject_Name = 'Physics';

INSERT INTO Scores (Student_ID, Subject_ID, Score)
SELECT r.Student_ID, s.Subject_ID, r.Chemistry
FROM students_raw r
JOIN Subjects s ON s.Subject_Name = 'Chemistry';

INSERT INTO Scores (Student_ID, Subject_ID, Score)
SELECT r.Student_ID, s.Subject_ID, r.Biology
FROM students_raw r
JOIN Subjects s ON s.Subject_Name = 'Biology';

INSERT INTO Scores (Student_ID, Subject_ID, Score)
SELECT r.Student_ID, s.Subject_ID, r.English
FROM students_raw r
JOIN Subjects s ON s.Subject_Name = 'English';

INSERT INTO Scores (Student_ID, Subject_ID, Score)
SELECT r.Student_ID, s.Subject_ID, r.History
FROM students_raw r
JOIN Subjects s ON s.Subject_Name = 'History';
